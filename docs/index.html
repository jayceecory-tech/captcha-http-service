<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>éªŒè¯ç è¯†åˆ«æœåŠ¡ - æ–‡æ¡£ & æµ‹è¯•</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin: 0; padding: 0; color: #222; background: #f6f8fb; }
    header { background: linear-gradient(90deg,#4b6cb7,#182848); color: #fff; padding: 24px; }
    .container { max-width: 980px; margin: 24px auto; padding: 16px; }
    h1 { margin: 0 0 6px 0; font-size: 20px; }
    p.lead { margin: 6px 0 0 0; color: #e6eefc; }
    .card { background: #fff; border-radius: 8px; padding: 16px; margin-bottom: 16px; box-shadow: 0 2px 8px rgba(23,31,60,0.06); }
    pre { background: #0d1117; color: #c9d1d9; padding: 12px; border-radius: 6px; overflow: auto; font-size: 13px; }
    label { display:block; margin: 8px 0 6px; font-weight:600; }
    textarea, input[type="text"], input[type="file"], select { width: 100%; padding:8px; box-sizing:border-box; border:1px solid #d8e1ef; border-radius:6px; }
    .row { display:flex; gap:16px; }
    .col { flex:1; }
    button { background:#2b7cff; color:#fff; border:none; padding:10px 14px; border-radius:6px; cursor:pointer; }
    button.secondary { background:#6c757d; }
    .result { white-space:pre-wrap; background:#0f1720; color:#e6eefc; padding:12px; border-radius:6px; margin-top:8px; }
    .meta { font-size:13px; color:#6b7280; }
    .flex { display:flex; gap:8px; align-items:center; }
    .small { font-size:13px; color:#6b7280; }
    .badge { display:inline-block; padding:4px 8px; background:#eef2ff; color:#312e81; border-radius:999px; font-weight:600; font-size:12px; }
    footer { text-align:center; color:#9aa4bf; font-size:13px; padding:16px 0; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>ğŸ” éªŒè¯ç è¯†åˆ«æœåŠ¡ â€” æ–‡æ¡£ä¸åœ¨çº¿æµ‹è¯•</h1>
      <p class="lead">è¯´æ˜æ¥å£ç”¨æ³•ã€ç¤ºä¾‹è¯·æ±‚ï¼Œå¹¶å¯ç›´æ¥åœ¨é¡µé¢ä¸Šä¼ å›¾ç‰‡æˆ–ç²˜è´´ Base64 è¿›è¡Œåœ¨çº¿æµ‹è¯•ã€‚</p>
    </div>
  </header>

  <div class="container">
    <div class="card">
      <h2>ğŸ“¡ API æ¦‚è§ˆ</h2>
      <p class="meta">ä¸»æ¥å£: <span class="badge">POST /recognize</span></p>
      <h3>è¯·æ±‚ï¼ˆJSONï¼‰</h3>
      <pre>{
  "base64": "å­—ç¬¦ä¸²ï¼Œæ”¯æŒåŒ…å« data:image/png;base64, å‰ç¼€ æˆ– çº¯ base64"
}</pre>
      <h3>æˆåŠŸå“åº”</h3>
      <pre>{
  "success": true,
  "code": 200,
  "message": "è¯†åˆ«æˆåŠŸ",
  "request_id": "xxxx",
  "data": {
    "captcha": "AB12",
    "time_ms": 120.45,
    "length": 4
  }
}</pre>
      <h3>é”™è¯¯å“åº”</h3>
      <pre>{
  "success": false,
  "code": 400,
  "message": "é”™è¯¯ä¿¡æ¯",
  "request_id": "xxxx",
  "data": null
}</pre>

      <h3>ç¤ºä¾‹ curl</h3>
      <pre id="curl-example">curl -X POST ${ORIGIN}/recognize \
  -H "Content-Type: application/json" \
  -d '{"base64":"data:image/png;base64,iVBORw0K..."}'</pre>
      <p class="small">æ³¨ï¼šé¡µé¢ä¸‹æ–¹æœ‰äº¤äº’å¼æµ‹è¯•ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨ã€‚</p>
    </div>

    <div class="card">
      <h2>ğŸ§ª åœ¨çº¿æµ‹è¯• (Try-It)</h2>

      <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
        <div>
          <label>1) é€‰æ‹©æœ¬åœ°å›¾ç‰‡æ–‡ä»¶ (PNG/JPEG)</label>
          <input id="fileInput" type="file" accept="image/*" />
          <div class="small" style="margin-top:6px;">æˆ–è€…</div>
          <label style="margin-top:8px;">ç²˜è´´ Base64 (å«æˆ–ä¸å« data: å‰ç¼€)</label>
          <textarea id="base64Input" rows="6" placeholder="data:image/png;base64,..." ></textarea>
        </div>

        <div>
          <label>2) è¯·æ±‚è®¾ç½®</label>
          <label>ç›®æ ‡ URL</label>
          <input id="targetUrl" type="text" value="" />
          <label style="margin-top:8px;">Content-Type</label>
          <input id="contentType" type="text" value="application/json" />
          <div style="margin-top:8px;" class="flex">
            <button id="sendBtn">å‘é€è¯·æ±‚</button>
            <button id="clearBtn" class="secondary">æ¸…é™¤</button>
          </div>
          <div class="small" style="margin-top:8px;">è¯´æ˜ï¼šè‹¥é€‰æ‹©æ–‡ä»¶ï¼Œé¡µé¢ä¼šè‡ªåŠ¨æŠŠå›¾ç‰‡è½¬æ¢ä¸º data:image/...;base64, å¹¶å¡«å…¥ Base64 æ–‡æœ¬æ¡†ã€‚</div>
        </div>
      </div>

      <div style="margin-top:12px;">
        <label>3) å“åº”ç»“æœ</label>
        <div id="result" class="result">å°šæœªè¯·æ±‚</div>
      </div>
    </div>

    <div class="card">
      <h2>âš™ï¸ ç¤ºä¾‹ä¸æ³¨æ„äº‹é¡¹</h2>
      <ul>
        <li>æ”¯æŒå« <code>data:image/png;base64,</code> å‰ç¼€æˆ–çº¯ Base64 å­—ç¬¦ä¸²ã€‚</li>
        <li>æœ€å¤§è¯·æ±‚ä½“å¤§å°å—æœåŠ¡ç«¯é™åˆ¶ï¼ˆé»˜è®¤ 10MBï¼‰ã€‚</li>
        <li>è‹¥éœ€è¦è·¨åŸŸä»æµè§ˆå™¨ç›´æ¥è°ƒç”¨ï¼Œè¯·ç¡®ä¿æœåŠ¡ç«¯è®¾ç½®å…è®¸çš„ Origin æˆ–åœ¨åŒåŸŸä¸‹æµ‹è¯•ã€‚</li>
        <li>ç»“æœå­—æ®µ <code>captcha</code> åªåŒ…å«å­—æ¯æˆ–æ•°å­—ï¼ˆéå­—æ¯æ•°å­—å­—ç¬¦ä¼šè¢«è¿‡æ»¤ï¼‰ã€‚</li>
      </ul>
    </div>
  </div>

  <footer>
    éªŒè¯ç è¯†åˆ«æœåŠ¡ â€¢ åœ¨çº¿æ–‡æ¡£ä¸æµ‹è¯•é¡µé¢
  </footer>

  <script>
    // Simple client-side logic to support Try-It
    (function () {
      const origin = window.location.origin || (window.location.protocol + '//' + window.location.host);
      const curlEl = document.getElementById('curl-example');
      curlEl.textContent = curlEl.textContent.replace('${ORIGIN}', origin);

      const fileInput = document.getElementById('fileInput');
      const base64Input = document.getElementById('base64Input');
      const sendBtn = document.getElementById('sendBtn');
      const clearBtn = document.getElementById('clearBtn');
      const resultEl = document.getElementById('result');
      const targetUrl = document.getElementById('targetUrl');

      // default target
      targetUrl.value = origin + '/recognize';

      fileInput.addEventListener('change', async (e) => {
        const f = e.target.files && e.target.files[0];
        if (!f) return;
        const reader = new FileReader();
        reader.onload = function (ev) {
          // dataURL
          base64Input.value = ev.target.result;
        };
        reader.readAsDataURL(f);
      });

      clearBtn.addEventListener('click', () => {
        base64Input.value = '';
        resultEl.textContent = 'å·²æ¸…é™¤';
      });

      sendBtn.addEventListener('click', async () => {
        const url = targetUrl.value.trim();
        if (!url) {
          resultEl.textContent = 'è¯·å¡«å†™ç›®æ ‡ URL';
          return;
        }
        let payloadBase64 = base64Input.value.trim();
        if (!payloadBase64) {
          resultEl.textContent = 'è¯·å…ˆé€‰æ‹©å›¾ç‰‡æˆ–ç²˜è´´ Base64';
          return;
        }

        // if user pasted plain base64 without data: prefix we still send as-is
        const body = { base64: payloadBase64 };

        resultEl.textContent = 'è¯·æ±‚ä¸­...';
        sendBtn.disabled = true;
        try {
          const res = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body),
          });
          const txt = await res.text();
          let pretty;
          try {
            pretty = JSON.stringify(JSON.parse(txt), null, 2);
          } catch (e) {
            pretty = txt;
          }
          resultEl.textContent = `HTTP ${res.status} ${res.statusText}\n\n${pretty}`;
        } catch (err) {
          resultEl.textContent = 'è¯·æ±‚å¤±è´¥: ' + String(err);
        } finally {
          sendBtn.disabled = false;
        }
      });

      // Allow paste of images from clipboard in modern browsers
      window.addEventListener('paste', async (e) => {
        const items = e.clipboardData && e.clipboardData.items;
        if (!items) return;
        for (let item of items) {
          if (item.type.indexOf('image') !== -1) {
            const blob = item.getAsFile();
            const reader = new FileReader();
            reader.onload = function (ev) {
              base64Input.value = ev.target.result;
            };
            reader.readAsDataURL(blob);
            break;
          }
        }
      });
    })();
  </script>
</body>
</html>
